<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Publications – Research Lab Manager</title>
    <style>
        body { font-family: Arial, sans-serif; background:#0f172a; color:#e5e7eb; margin:0; }
        header {
            background:#111827; padding:1rem 2rem;
            display:flex; justify-content:space-between; align-items:center;
            border-bottom:1px solid #1f2937;
        }
        header h1 { margin:0; font-size:1.3rem; }
        header a { color:#f97316; text-decoration:none; font-size:0.9rem; }
        nav {
            background:#1e293b; padding:0.8rem 2rem;
            display:flex; gap:1.5rem; border-bottom:1px solid #334155;
        }
        nav a { color:#93c5fd; text-decoration:none; font-weight:bold; }
        nav a:hover { color:#3b82f6; }
        main { padding:2rem; }
        table { width:100%; border-collapse:collapse; margin-bottom:2rem; }
        th, td {
            border:1px solid #1f2937; padding:0.6rem 0.8rem;
            font-size:0.85rem;
        }
        th { background:#111827; }
        tr:nth-child(even) { background:#111827; }
        tr:nth-child(odd) { background:#020617; }
        h2 { margin-top:0; }
        .form-card {
            background:#111827; padding:1.2rem 1.5rem;
            border-radius:10px; max-width:650px;
        }
        label { display:block; margin-top:0.6rem; font-size:0.85rem; }
        input {
            width:100%; padding:0.45rem; margin-top:0.2rem;
            border-radius:6px; border:1px solid #4b5563;
            background:#020617; color:#e5e7eb;
        }
        button {
            margin-top:0.4rem; padding:0.4rem 0.9rem;
            border:none; border-radius:6px;
            background:#2563eb; color:white; font-weight:bold;
            cursor:pointer; font-size:0.8rem;
        }
        button:hover { background:#1d4ed8; }
        .flash {
            padding:0.4rem 0.6rem; margin-bottom:0.8rem;
            border-radius:4px; font-size:0.8rem;
        }
        .flash.error { background:#b91c1c; }
        .flash.success { background:#15803d; }
        .flash.info { background:#0369a1; }

        .actions {
            display:flex;
            gap:0.4rem;
        }
        .actions a {
            padding:0.35rem 0.7rem;
            border-radius:6px;
            background:#4b5563;
            color:white;
            text-decoration:none;
            font-size:0.8rem;
        }
        .actions a:hover {
            background:#6b7280;
        }
        .actions form {
            display:inline;
            margin:0;
        }
    </style>
</head>
<body>

<header>
    <h1>Research Lab Manager – Publications</h1>
    <div>
        <a href="{{ url_for('dashboard') }}">Dashboard</a> |
        <a href="{{ url_for('logout') }}">Logout</a>
    </div>
</header>

<nav>
    <a href="{{ url_for('members') }}">Members</a>
    <a href="{{ url_for('projects') }}">Projects</a>
    <a href="{{ url_for('equipment') }}">Equipment</a>
    <a href="{{ url_for('grants') }}">Grants</a>
    <a href="{{ url_for('publications') }}">Publications</a>
    <a href="{{ url_for('reports') }}">Reports</a>
</nav>

<main>

    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        {% for category, msg in messages %}
          <div class="flash {{ category }}">{{ msg }}</div>
        {% endfor %}
      {% endif %}
    {% endwith %}

    <h2>Existing Publications</h2>
    <table>
        <thead>
            <tr>
                <th>Pub ID</th>
                <th>Title</th>
                <th>Venue</th>
                <th>Publication Date</th>
                <th>DOI</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
        {% for p in publications %}
            <tr>
                <td>{{ p.pubid }}</td>
                <td>{{ p.title }}</td>
                <td>{{ p.venue }}</td>
                <td>{{ p.pdate }}</td>
                <td>{{ p.doi }}</td>
                <td>
                    <div class="actions">
                        <a href="{{ url_for('edit_publication', pubid=p.pubid) }}">Edit</a>

                        <form method="POST"
                              action="{{ url_for('delete_publication', pubid=p.pubid) }}"
                              onsubmit="return confirm('Delete this publication?');">
                            <button type="submit">Delete</button>
                        </form>
                    </div>
                </td>
            </tr>
        {% else %}
            <tr><td colspan="6">No publications added yet.</td></tr>
        {% endfor %}
        </tbody>
    </table>

    <h2>Add New Publication</h2>
    <div class="form-card">
        <form method="POST" action="{{ url_for('add_publication') }}">
            <label for="title">Title</label>
            <input id="title" name="title" required>

            <label for="venue">Venue</label>
            <input id="venue" name="venue" placeholder="Conference / Journal name" required>

            <label for="pdate">Publication Date</label>
            <input id="pdate" name="pdate" type="date" required>

            <label for="doi">DOI (optional)</label>
            <input id="doi" name="doi" placeholder="10.xxxx/xxxxx">

            <button type="submit">Add Publication</button>
        </form>
    </div>

</main>

</body>
</html>
